<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Blockchain Security Attack Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3a 50%, #2d1b69 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.8em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00f5ff, #ff00ff, #00ff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 3s ease-in-out infinite;
        }

        @keyframes gradient-shift {
            0%, 100% { filter: hue-rotate(0deg); }
            50% { filter: hue-rotate(180deg); }
        }

        .attack-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .category-section {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .category-title {
            font-size: 1.4em;
            margin-bottom: 20px;
            color: #00f5ff;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 245, 255, 0.3);
        }

        .attack-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .attack-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .attack-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .attack-card:hover::before {
            left: 100%;
        }

        .attack-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 245, 255, 0.2);
            border-color: rgba(0, 245, 255, 0.5);
        }

        .attack-card.active {
            border-color: #00f5ff;
            box-shadow: 0 0 30px rgba(0, 245, 255, 0.6);
            background: rgba(0, 245, 255, 0.1);
        }

        .attack-title {
            font-size: 1.1em;
            margin-bottom: 8px;
            color: #00f5ff;
            font-weight: bold;
        }

        .attack-description {
            font-size: 0.85em;
            color: #cccccc;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .attack-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }

        .severity {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.75em;
            font-weight: bold;
        }

        .severity.critical { background: linear-gradient(45deg, #ff4757, #ff3742); }
        .severity.high { background: linear-gradient(45deg, #ff6b35, #ff5722); }
        .severity.medium { background: linear-gradient(45deg, #ffa502, #ff9500); }
        .severity.low { background: linear-gradient(45deg, #2ed573, #27ae60); }

        .complexity {
            font-size: 0.75em;
            color: #888;
        }

        .simulator-area {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 20px;
            padding: 35px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transition: all 0.6s ease;
            transform: translate(-50%, -50%);
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #00f5ff, #0080ff);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ff4757, #ff3742);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffa502, #ff6348);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #2ed573, #27ae60);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(0, 245, 255, 0.2);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #00f5ff;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #cccccc;
            font-size: 0.9em;
        }

        .visualization-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .viz-panel {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .viz-title {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #00f5ff;
            text-align: center;
        }

        .blockchain-visual {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            overflow-x: auto;
            padding: 20px 5px;
            min-height: 100px;
        }

        .block {
            min-width: 100px;
            height: 70px;
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.4s ease;
            border: 2px solid transparent;
            font-size: 0.8em;
            font-weight: bold;
        }

        .block.compromised {
            background: linear-gradient(45deg, #ff4757, #ff3742);
            animation: pulse-red 1.5s infinite;
            border-color: #ff4757;
        }

        .block.mining {
            background: linear-gradient(45deg, #ffa502, #ff6348);
            animation: mining-rotation 2s infinite linear;
        }

        .block.withheld {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
            animation: pulse-purple 1.2s infinite;
        }

        .block.forked {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            border: 2px dashed #f39c12;
        }

        .block::after {
            content: '→';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            color: #4ECDC4;
            font-size: 1.2em;
            font-weight: bold;
        }

        .block:last-child::after {
            display: none;
        }

        .network-topology {
            position: relative;
            height: 350px;
            margin: 20px 0;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .node {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            display: flex;
            align-items: center;
            justify-content: center;
            position: absolute;
            transition: all 0.4s ease;
            border: 3px solid transparent;
            font-weight: bold;
            font-size: 0.75em;
            cursor: pointer;
        }

        .node:hover {
            transform: scale(1.2);
            z-index: 10;
        }

        .node.honest {
            background: linear-gradient(45deg, #4ECDC4, #44A08D);
            border-color: #4ECDC4;
        }

        .node.attacker {
            background: linear-gradient(45deg, #ff4757, #ff3742);
            border-color: #ff4757;
            animation: pulse-red 2s infinite;
        }

        .node.victim {
            background: linear-gradient(45deg, #ffa502, #ff6348);
            border-color: #ffa502;
            animation: shake 1s infinite;
        }

        .node.sybil {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
            border-color: #8e44ad;
            animation: pulse-purple 1.5s infinite;
        }

        .node.miner {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            border-color: #f39c12;
        }

        .connection {
            position: absolute;
            height: 2px;
            background: rgba(255, 255, 255, 0.3);
            transform-origin: left center;
            transition: all 0.3s ease;
        }

        .connection.active {
            background: #00f5ff;
            height: 3px;
            box-shadow: 0 0 10px #00f5ff;
        }

        .connection.malicious {
            background: #ff4757;
            height: 3px;
            animation: pulse-connection 1s infinite;
        }

        .mining-pool {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .pool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .pool-name {
            font-weight: bold;
            color: #00f5ff;
        }

        .pool-hashrate {
            color: #ffa502;
            font-size: 0.9em;
        }

        .miners-list {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .miner {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(45deg, #2ed573, #27ae60);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .miner.hopping {
            background: linear-gradient(45deg, #ff6b35, #ff5722);
            animation: hop 1s infinite;
        }

        .smart-contract-panel {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .contract-code {
            background: #000;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
            margin: 15px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 200px;
            overflow-y: auto;
        }

        .vulnerability-highlight {
            background: rgba(255, 71, 87, 0.2);
            border-left: 3px solid #ff4757;
            padding: 2px 5px;
            margin: 2px 0;
        }

        .wallet-security {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .wallet-type {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .wallet-type:hover {
            transform: scale(1.05);
            border-color: #00f5ff;
        }

        .wallet-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .security-level {
            margin-top: 10px;
            padding: 5px;
            border-radius: 5px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .voting-system {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .vote-option {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .vote-option:hover {
            background: rgba(0, 245, 255, 0.1);
            border-color: #00f5ff;
        }

        .vote-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-top: 8px;
            overflow: hidden;
        }

        .vote-progress {
            height: 100%;
            background: linear-gradient(90deg, #00f5ff, #0080ff);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .logs {
            background: #000;
            border-radius: 12px;
            padding: 20px;
            margin: 25px 0;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .log-entry {
            margin: 8px 0;
            padding: 3px 0;
            border-left: 3px solid transparent;
            padding-left: 10px;
        }

        .log-info { 
            color: #00f5ff; 
            border-color: #00f5ff;
        }
        .log-warning { 
            color: #ffa502; 
            border-color: #ffa502;
        }
        .log-error { 
            color: #ff4757; 
            border-color: #ff4757;
        }
        .log-success { 
            color: #2ed573; 
            border-color: #2ed573;
        }
        .log-critical {
            color: #ff3742;
            border-color: #ff3742;
            background: rgba(255, 71, 87, 0.1);
            font-weight: bold;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(26, 26, 58, 0.95));
            border-radius: 25px;
            padding: 40px;
            max-width: 800px;
            width: 95%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }

        .close {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 32px;
            cursor: pointer;
            color: #ffffff;
            transition: all 0.3s ease;
        }

        .close:hover {
            color: #ff4757;
            transform: scale(1.2);
        }

        .progress-ring {
            width: 120px;
            height: 120px;
            margin: 20px auto;
            position: relative;
        }

        .progress-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(#00f5ff 0deg, transparent 0deg);
            transition: all 0.5s ease;
        }

        @keyframes pulse-red {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(255, 71, 87, 0); }
        }

        @keyframes pulse-purple {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(142, 68, 173, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(142, 68, 173, 0); }
        }

        @keyframes mining-rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes hop {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse-connection {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .attack-progress {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            height: 12px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00f5ff, #ff00ff, #00ff00);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 15px;
            position: relative;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progress-shine 2s infinite;
        }

        @keyframes progress-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .attack-categories {
                grid-template-columns: 1fr;
            }
            
            .controls {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .visualization-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🛡️ Complete Blockchain Security Attack Simulator</h1>
            <p>Comprehensive educational platform for understanding all blockchain attack vectors and security mechanisms</p>
        </div>

        <div class="attack-categories">
            <!-- Consensus & Mining Attacks -->
            <div class="category-section">
                <div class="category-title">⛏️ Consensus & Mining Attacks</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="51attack">
                        <div class="attack-title">51% Attack</div>
                        <div class="attack-description">Control majority hash power to reorganize blockchain and double-spend</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="selfish">
                        <div class="attack-title">Selfish Mining</div>
                        <div class="attack-description">Strategically withhold blocks to gain unfair mining advantage</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="bwh">
                        <div class="attack-title">Block Withholding (BWH)</div>
                        <div class="attack-description">Withhold valid blocks to damage competing pools</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="faw">
                        <div class="attack-title">Fork After Withholding (FAW)</div>
                        <div class="attack-description">Advanced attack combining selfish mining with block withholding</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Network Attacks -->
            <div class="category-section">
                <div class="category-title">🌐 Network & Protocol Attacks</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="eclipse">
                        <div class="attack-title">Eclipse Attack</div>
                        <div class="attack-description">Isolate target node by controlling all its connections</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="sybil">
                        <div class="attack-title">Sybil Attack</div>
                        <div class="attack-description">Create multiple fake identities to influence network consensus</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="dos">
                        <div class="attack-title">DoS Attack</div>
                        <div class="attack-description">Overwhelm network nodes with excessive requests</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="routing">
                        <div class="attack-title">BGP Hijacking</div>
                        <div class="attack-description">Manipulate internet routing to intercept blockchain traffic</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pool & Mining Attacks -->
            <div class="category-section">
                <div class="category-title">🏊 Pool & Mining Attacks</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="pool-hopping">
                        <div class="attack-title">Pool Hopping</div>
                        <div class="attack-description">Jump between pools to maximize rewards at others' expense</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="pool-cannibalization">
                        <div class="attack-title">Pool Cannibalization</div>
                        <div class="attack-description">Use multiple identities to extract maximum value from pools</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="stubborn-mining">
                        <div class="attack-title">Stubborn Mining</div>
                        <div class="attack-description">Enhanced selfish mining strategy with adaptive behavior</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Smart Contract & DApp Attacks -->
            <div class="category-section">
                <div class="category-title">📜 Smart Contract & DApp Attacks</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="reentrancy">
                        <div class="attack-title">Reentrancy Attack</div>
                        <div class="attack-description">Exploit recursive calling to drain contract funds</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="overflow">
                        <div class="attack-title">Integer Overflow</div>
                        <div class="attack-description">Exploit arithmetic overflow to manipulate contract state</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="front-running">
                        <div class="attack-title">Front-Running</div>
                        <div class="attack-description">Exploit transaction ordering to gain unfair advantage</div>
                        <div class="attack-meta">
                            <span class="severity medium">Medium</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="flash-loan">
                        <div class="attack-title">Flash Loan Attack</div>
                        <div class="attack-description">Use uncollateralized loans to manipulate DeFi protocols</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Wallet & User Attacks -->
            <div class="category-section">
                <div class="category-title">👛 Wallet & User Security</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="private-key">
                        <div class="attack-title">Private Key Extraction</div>
                        <div class="attack-description">Extract private keys through various attack vectors</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="seed-phrase">
                        <div class="attack-title">Seed Phrase Attack</div>
                        <div class="attack-description">Target mnemonic phrases through social engineering</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="clipboard">
                        <div class="attack-title">Clipboard Hijacking</div>
                        <div class="attack-description">Replace copied addresses with attacker's addresses</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">Low Complexity</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Governance & Voting Attacks -->
            <div class="category-section">
                <div class="category-title">🗳️ Governance & Voting Attacks</div>
                <div class="attack-grid">
                    <div class="attack-card" data-attack="vote-buying">
                        <div class="attack-title">Vote Buying</div>
                        <div class="attack-description">Purchase votes to manipulate governance decisions</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">Medium Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="governance-attack">
                        <div class="attack-title">Governance Takeover</div>
                        <div class="attack-description">Acquire majority voting power to control protocol</div>
                        <div class="attack-meta">
                            <span class="severity critical">Critical</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                    <div class="attack-card" data-attack="flash-governance">
                        <div class="attack-title">Flash Governance</div>
                        <div class="attack-description">Use flash loans to temporarily gain voting power</div>
                        <div class="attack-meta">
                            <span class="severity high">High</span>
                            <span class="complexity">High Complexity</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="simulator-area">
            <h2>🎯 Advanced Attack Simulation Dashboard</h2>
            
            <div class="controls">
                <button class="btn btn-primary" onclick="startSimulation()">🚀 Start Attack</button>
                <button class="btn btn-danger" onclick="stopSimulation()">⛔ Stop Attack</button>
                <button class="btn btn-warning" onclick="resetNetwork()">🔄 Reset Network</button>
                <button class="btn btn-success" onclick="scanVulnerabilities()">🔍 Security Scan</button>
                <button class="btn btn-primary" onclick="deployDefenses()">🛡️ Deploy Defenses</button>
                <button class="btn btn-warning" onclick="analyzeTraffic()">📊 Traffic Analysis</button>
            </div>

            <div class="stats-dashboard">
                <div class="stat-card">
                    <div class="stat-value" id="hashpower">0%</div>
                    <div class="stat-label">Attacker Hash Power</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="blocks">0</div>
                    <div class="stat-label">Compromised Blocks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="success">0%</div>
                    <div class="stat-label">Attack Success Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="nodes">12</div>
                    <div class="stat-label">Network Nodes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="transactions">0</div>
                    <div class="stat-label">Intercepted Transactions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="funds">$0</div>
                    <div class="stat-label">Funds at Risk</div>
                </div>
            </div>

            <div class="attack-progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div class="visualization-grid">
                <div class="viz-panel">
                    <div class="viz-title">🔗 Blockchain State Monitor</div>
                    <div class="blockchain-visual" id="blockchain"></div>
                    <div style="text-align: center; margin-top: 15px;">
                        <small>🟢 Honest Block | 🔴 Compromised | 🟡 Mining | 🟣 Withheld | 🟠 Forked</small>
                    </div>
                </div>

                <div class="viz-panel">
                    <div class="viz-title">🌐 Network Topology</div>
                    <div class="network-topology" id="networkGraph"></div>
                </div>

                <div class="viz-panel">
                    <div class="viz-title">🏊 Mining Pool Monitor</div>
                    <div id="miningPools"></div>
                </div>

                <div class="viz-panel">
                    <div class="viz-title">👛 Wallet Security Status</div>
                    <div class="wallet-security" id="walletSecurity"></div>
                </div>
            </div>

            <div class="visualization-grid">
                <div class="viz-panel smart-contract-panel">
                    <div class="viz-title">📜 Smart Contract Analyzer</div>
                    <div class="contract-code" id="contractCode">
// Sample Vulnerable Contract
pragma solidity ^0.8.0;

contract VulnerableBank {
    mapping(address => uint) public balances;
    
    function deposit() public payable {
        balances[msg.sender] += msg.value;
    }
    
    <span class="vulnerability-highlight">function withdraw(uint amount) public {
        require(balances[msg.sender] >= amount);
        (bool success, ) = msg.sender.call{value: amount}("");
        require(success);
        balances[msg.sender] -= amount; // State update after external call!
    }</span>
}
                    </div>
                    <div style="margin-top: 10px;">
                        <span style="color: #ff4757;">⚠️ Vulnerability: Reentrancy attack possible</span>
                    </div>
                </div>

                <div class="viz-panel">
                    <div class="viz-title">🗳️ Governance Voting System</div>
                    <div class="voting-system" id="votingSystem">
                        <div class="vote-option" onclick="castVote(0)">
                            <div>Proposal A: Increase Block Size</div>
                            <div class="vote-bar">
                                <div class="vote-progress" style="width: 35%"></div>
                            </div>
                            <small>35% (1,234 votes)</small>
                        </div>
                        <div class="vote-option" onclick="castVote(1)">
                            <div>Proposal B: Implement PoS</div>
                            <div class="vote-bar">
                                <div class="vote-progress" style="width: 45%"></div>
                            </div>
                            <small>45% (1,587 votes)</small>
                        </div>
                        <div class="vote-option" onclick="castVote(2)">
                            <div>Proposal C: Hard Fork</div>
                            <div class="vote-bar">
                                <div class="vote-progress" style="width: 20%"></div>
                            </div>
                            <small>20% (705 votes)</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="logs" id="logs">
                <div class="log-entry log-info">[INFO] Advanced Blockchain Security Simulator initialized</div>
                <div class="log-entry log-info">[INFO] Network contains 12 honest nodes across 4 mining pools</div>
                <div class="log-entry log-success">[SUCCESS] Security monitoring systems active</div>
                <div class="log-entry log-info">[INFO] Select an attack type to begin comprehensive simulation</div>
                <div class="log-entry log-warning">[WARNING] Multiple attack vectors detected in network</div>
            </div>
        </div>
    </div>

    <!-- Attack Details Modal -->
    <div id="attackModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle">Attack Details</h2>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Global simulation state
        let currentAttack = null;
        let simulationInterval = null;
        let blocks = [];
        let networkNodes = [];
        let miningPools = [];
        let wallets = [];
        let attackProgress = 0;
        let attackerHashPower = 0;
        let compromisedBlocks = 0;
        let interceptedTx = 0;
        let fundsAtRisk = 0;
        let isSimulationRunning = false;

        // Comprehensive attack definitions
        const attacks = {
            '51attack': {
                title: '51% Attack Simulation',
                description: 'Attacker gains majority control of network hash power to reorganize blockchain and execute double-spend attacks.',
                mechanism: 'Build private chain faster than honest network, then broadcast to reorganize blockchain history.',
                defense: 'Increase network decentralization, implement rolling checkpoints, use hybrid consensus mechanisms.',
                hashPowerRequired: 51,
                duration: 45000,
                fundsRisk: 500000,
                complexity: 'High',
                realWorldExamples: 'Bitcoin Gold (2018), Ethereum Classic (2019), Verge (2018)'
            },
            'selfish': {
                title: 'Selfish Mining Attack',
                description: 'Miners withhold discovered blocks and release them strategically to waste honest miners\' work.',
                mechanism: 'Mine privately, publish blocks only when advantageous to cause honest miners to work on stale chains.',
                defense: 'Implement uncle block rewards, random beacon protocols, immediate block propagation.',
                hashPowerRequired: 25,
                duration: 35000,
                fundsRisk: 200000,
                complexity: 'Medium',
                realWorldExamples: 'Theoretical attack, observed in Bitcoin mining pools'
            },
            'bwh': {
                title: 'Block Withholding (BWH) Attack',
                description: 'Attacker participates in mining pool but withholds valid block solutions to damage the pool.',
                mechanism: 'Submit partial proofs of work but withhold full solutions, reducing pool rewards.',
                defense: 'Implement proof verification, use commit-reveal schemes, monitor miner behavior.',
                hashPowerRequired: 15,
                duration: 25000,
                fundsRisk: 75000,
                complexity: 'Medium',
                realWorldExamples: 'Multiple Bitcoin mining pools affected'
            },
            'faw': {
                title: 'Fork After Withholding (FAW) Attack',
                description: 'Advanced attack combining selfish mining with block withholding strategies.',
                mechanism: 'Withhold blocks then create forks at strategic moments to maximize damage.',
                defense: 'Enhanced monitoring, rapid fork detection, economic penalties for suspicious behavior.',
                hashPowerRequired: 30,
                duration: 40000,
                fundsRisk: 350000,
                complexity: 'High',
                realWorldExamples: 'Theoretical advanced attack vector'
            },
            'eclipse': {
                title: 'Eclipse Attack',
                description: 'Attacker controls all of victim node\'s network connections to isolate it from honest network.',
                mechanism: 'Monopolize victim\'s peer connections to feed false blockchain information.',
                defense: 'Diverse peer selection, connection monitoring, trusted node bootstrapping.',
                hashPowerRequired: 0,
                duration: 30000,
                fundsRisk: 100000,
                complexity: 'Medium',
                realWorldExamples: 'Bitcoin nodes targeted, Ethereum client vulnerabilities'
            },
            'sybil': {
                title: 'Sybil Attack',
                description: 'Create numerous fake identities to gain disproportionate influence in network decisions.',
                mechanism: 'Generate many fake nodes to outnumber honest participants in consensus.',
                defense: 'Proof-of-Work, Proof-of-Stake, identity verification, reputation systems.',
                hashPowerRequired: 0,
                duration: 35000,
                fundsRisk: 150000,
                complexity: 'Low',
                realWorldExamples: 'P2P networks, social networks, reputation systems'
            },
            'dos': {
                title: 'Denial of Service Attack',
                description: 'Overwhelm network nodes with excessive requests to disrupt normal operations.',
                mechanism: 'Flood nodes with invalid transactions or excessive connection requests.',
                defense: 'Rate limiting, IP blacklisting, traffic analysis, robust network architecture.',
                hashPowerRequired: 0,
                duration: 20000,
                fundsRisk: 50000,
                complexity: 'Low',
                realWorldExamples: 'Ethereum network congestion, Bitcoin node flooding'
            },
            'routing': {
                title: 'BGP Hijacking Attack',
                description: 'Manipulate internet routing protocols to intercept blockchain network traffic.',
                mechanism: 'Hijack BGP routes to redirect blockchain traffic through attacker infrastructure.',
                defense: 'BGP monitoring, route filtering, encrypted connections, diverse routing.',
                hashPowerRequired: 0,
                duration: 60000,
                fundsRisk: 1000000,
                complexity: 'High',
                realWorldExamples: 'Bitcoin traffic hijacking (2014), various cryptocurrency exchanges'
            },
            'pool-hopping': {
                title: 'Pool Hopping Attack',
                description: 'Strategically switch between mining pools to maximize personal rewards.',
                mechanism: 'Join pools when probability of finding blocks is high, leave when low.',
                defense: 'Implement Pay-Per-Last-N-Shares (PPLNS), score-based reward systems.',
                hashPowerRequired: 10,
                duration: 30000,
                fundsRisk: 80000,
                complexity: 'Low',
                realWorldExamples: 'Early Bitcoin mining pools, various altcoin pools'
            },
            'pool-cannibalization': {
                title: 'Pool Cannibalization Attack',
                description: 'Use multiple identities to extract maximum value from mining pools.',
                mechanism: 'Create multiple pool accounts to manipulate reward distribution.',
                defense: 'Identity verification, behavior analysis, anti-Sybil measures.',
                hashPowerRequired: 20,
                duration: 35000,
                fundsRisk: 120000,
                complexity: 'Medium',
                realWorldExamples: 'Mining pool manipulation cases'
            },
            'stubborn-mining': {
                title: 'Stubborn Mining Attack',
                description: 'Enhanced selfish mining with adaptive strategies based on network state.',
                mechanism: 'Dynamically adjust mining strategy based on honest network response.',
                defense: 'Randomized block propagation, economic incentive alignment.',
                hashPowerRequired: 35,
                duration: 50000,
                fundsRisk: 400000,
                complexity: 'High',
                realWorldExamples: 'Theoretical advanced mining attack'
            },
            'reentrancy': {
                title: 'Reentrancy Attack',
                description: 'Exploit recursive function calls in smart contracts to drain funds.',
                mechanism: 'Call contract function recursively before state is updated.',
                defense: 'Checks-Effects-Interactions pattern, reentrancy guards, formal verification.',
                hashPowerRequired: 0,
                duration: 15000,
                fundsRisk: 2000000,
                complexity: 'Medium',
                realWorldExamples: 'The DAO hack (2016), various DeFi protocols'
            },
            'overflow': {
                title: 'Integer Overflow Attack',
                description: 'Exploit arithmetic overflow to manipulate contract state and balances.',
                mechanism: 'Cause integer overflow to wrap values and bypass security checks.',
                defense: 'Use SafeMath libraries, compiler checks, extensive testing.',
                hashPowerRequired: 0,
                duration: 10000,
                fundsRisk: 300000,
                complexity: 'Low',
                realWorldExamples: 'BeautyChain (2018), various ERC-20 tokens'
            },
            'front-running': {
                title: 'Front-Running Attack',
                description: 'Exploit transaction ordering to gain unfair advantage in trading.',
                mechanism: 'Monitor mempool, submit transactions with higher gas to execute first.',
                defense: 'Commit-reveal schemes, batch processing, fair sequencing services.',
                hashPowerRequired: 0,
                duration: 12000,
                fundsRisk: 500000,
                complexity: 'Medium',
                realWorldExamples: 'DEX arbitrage, MEV extraction, NFT drops'
            },
            'flash-loan': {
                title: 'Flash Loan Attack',
                description: 'Use uncollateralized loans to manipulate DeFi protocols within single transaction.',
                mechanism: 'Borrow large amounts, manipulate prices, profit, repay loan in same transaction.',
                defense: 'Price oracle diversity, time delays, flash loan detection.',
                hashPowerRequired: 0,
                duration: 8000,
                fundsRisk: 10000000,
                complexity: 'High',
                realWorldExamples: 'Harvest Finance, bZx protocol, Cream Finance'
            },
            'private-key': {
                title: 'Private Key Extraction Attack',
                description: 'Extract private keys through various attack vectors and vulnerabilities.',
                mechanism: 'Side-channel attacks, malware, weak random number generation.',
                defense: 'Hardware security modules, secure key generation, cold storage.',
                hashPowerRequired: 0,
                duration: 25000,
                fundsRisk: 5000000,
                complexity: 'Medium',
                realWorldExamples: 'Weak RNG in Bitcoin wallets, hardware wallet attacks'
            },
            'seed-phrase': {
                title: 'Seed Phrase Attack',
                description: 'Target mnemonic seed phrases through social engineering and phishing.',
                mechanism: 'Phishing websites, fake wallet apps, social engineering.',
                defense: 'User education, secure storage, multi-factor authentication.',
                hashPowerRequired: 0,
                duration: 15000,
                fundsRisk: 2000000,
                complexity: 'Low',
                realWorldExamples: 'Fake wallet apps, phishing websites, social engineering'
            },
            'clipboard': {
                title: 'Clipboard Hijacking Attack',
                description: 'Replace copied cryptocurrency addresses with attacker\'s addresses.',
                mechanism: 'Malware monitors clipboard and replaces addresses when detected.',
                defense: 'Address verification, clipboard monitoring, endpoint security.',
                hashPowerRequired: 0,
                duration: 20000,
                fundsRisk: 800000,
                complexity: 'Low',
                realWorldExamples: 'CryptoShuffler malware, various clipboard hijackers'
            },
            'vote-buying': {
                title: 'Vote Buying Attack',
                description: 'Purchase governance tokens or voting rights to manipulate protocol decisions.',
                mechanism: 'Acquire voting tokens through markets or incentive programs.',
                defense: 'Quadratic voting, time-locked voting, voter verification.',
                hashPowerRequired: 0,
                duration: 40000,
                fundsRisk: 1500000,
                complexity: 'Medium',
                realWorldExamples: 'Various DeFi governance attacks, Steem takeover'
            },
            'governance-attack': {
                title: 'Governance Takeover Attack',
                description: 'Acquire majority voting power to completely control protocol governance.',
                mechanism: 'Accumulate governance tokens to control protocol upgrades and parameters.',
                defense: 'Distributed token allocation, voting delays, emergency procedures.',
                hashPowerRequired: 0,
                duration: 60000,
                fundsRisk: 50000000,
                complexity: 'High',
                realWorldExamples: 'Steemit/Tron takeover, various DAO attacks'
            },
            'flash-governance': {
                title: 'Flash Governance Attack',
                description: 'Use flash loans to temporarily acquire voting power for governance attacks.',
                mechanism: 'Flash loan governance tokens, vote on proposals, return tokens.',
                defense: 'Voting delays, token lock periods, flash loan restrictions.',
                hashPowerRequired: 0,
                duration: 5000,
                fundsRisk: 20000000,
                complexity: 'High',
                realWorldExamples: 'Theoretical attack, prevented by most protocols'
            }
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeSimulation();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.querySelectorAll('.attack-card').forEach(card => {
                card.addEventListener('click', function() {
                    selectAttack(this.dataset.attack);
                });
            });

            // Add keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeModal();
                if (e.key === 'Enter' && e.ctrlKey) startSimulation();
                if (e.key === 's' && e.ctrlKey) {
                    e.preventDefault();
                    stopSimulation();
                }
            });
        }

        function initializeSimulation() {
            initializeBlockchain();
            initializeNetwork();
            initializeMiningPools();
            initializeWallets();
            updateAllStats();
            logMessage('Advanced blockchain security simulator ready', 'success');
            logMessage('All systems initialized and monitoring active', 'info');
        }

        function selectAttack(attackType) {
            // Clear previous selection
            document.querySelectorAll('.attack-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Select new attack
            document.querySelector(`[data-attack="${attackType}"]`).classList.add('active');
            currentAttack = attackType;
            
            showAttackDetails(attackType);
            logMessage(`Selected attack: ${attacks[attackType].title}`, 'info');
            logMessage(`Complexity: ${attacks[attackType].complexity} | Funds at risk: $${attacks[attackType].fundsRisk.toLocaleString()}`, 'warning');
        }

        function showAttackDetails(attackType) {
            const attack = attacks[attackType];
            document.getElementById('modalTitle').textContent = attack.title;
            document.getElementById('modalContent').innerHTML = `
                <h3>🎯 Attack Overview</h3>
                <p><strong>Description:</strong> ${attack.description}</p>
                
                <h3>⚙️ Attack Mechanism</h3>
                <p>${attack.mechanism}</p>
                
                <h3>🛡️ Defense Strategies</h3>
                <p>${attack.defense}</p>
                
                <h3>📊 Attack Parameters</h3>
                <ul style="margin: 15px 0; padding-left: 20px;">
                    <li><strong>Hash Power Required:</strong> ${attack.hashPowerRequired}%</li>
                    <li><strong>Estimated Duration:</strong> ${(attack.duration/1000).toFixed(1)} seconds</li>
                    <li><strong>Funds at Risk:</strong> $${attack.fundsRisk.toLocaleString()}</li>
                    <li><strong>Complexity Level:</strong> ${attack.complexity}</li>
                </ul>
                
                <h3>🌍 Real-World Examples</h3>
                <p><em>${attack.realWorldExamples}</em></p>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(255, 71, 87, 0.1); border-radius: 8px; border-left: 4px solid #ff4757;">
                    <strong>⚠️ Educational Warning:</strong> This simulation is for educational purposes only. 
                    Attempting these attacks on real networks is illegal and unethical.
                </div>
            `;
            document.getElementById('attackModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('attackModal').style.display = 'none';
        }

        function initializeBlockchain() {
            blocks = [];
            for (let i = 0; i < 8; i++) {
                blocks.push({
                    id: i,
                    type: 'honest',
                    timestamp: Date.now() - (7-i) * 10000,
                    transactions: Math.floor(Math.random() * 2000) + 500,
                    miner: `Pool ${Math.floor(Math.random() * 4) + 1}`
                });
            }
            renderBlockchain();
        }

        function initializeNetwork() {
            networkNodes = [];
            const nodeTypes = ['honest', 'honest', 'honest', 'honest', 'honest', 'honest', 'honest', 'honest', 'miner', 'miner', 'target', 'target'];
            
            for (let i = 0; i < 12; i++) {
                const angle = (i / 12) * 2 * Math.PI;
                const radius = 120 + Math.random() * 60;
                networkNodes.push({
                    id: i,
                    type: nodeTypes[i],
                    x: Math.cos(angle) * radius + 175,
                    y: Math.sin(angle) * radius + 175,
                    connections: [],
                    status: 'online',
                    hashRate: Math.random() * 100
                });
            }
            
            // Create random connections
            networkNodes.forEach(node => {
                const connectionCount = Math.floor(Math.random() * 4) + 2;
                for (let i = 0; i < connectionCount; i++) {
                    const target = Math.floor(Math.random() * networkNodes.length);
                    if (target !== node.id && !node.connections.includes(target)) {
                        node.connections.push(target);
                    }
                }
            });
            
            renderNetwork();
        }

        function initializeMiningPools() {
            miningPools = [
                { name: 'HonestPool Alpha', hashRate: 25.5, miners: 150, type: 'honest' },
                { name: 'MegaMine Beta', hashRate: 22.3, miners: 120, type: 'honest' },
                { name: 'CryptoPool Gamma', hashRate: 18.7, miners: 95, type: 'honest' },
                { name: 'ShadowPool Delta', hashRate: 15.2, miners: 80, type: 'suspicious' }
            ];
            renderMiningPools();
        }

        function initializeWallets() {
            wallets = [
                { type: 'Hardware', security: 'high', icon: '🔒', status: 'secure', funds: 15.7 },
                { type: 'Desktop', security: 'medium', icon: '💻', status: 'warning', funds: 8.3 },
                { type: 'Mobile', security: 'medium', icon: '📱', status: 'secure', funds: 3.2 },
                { type: 'Web', security: 'low', icon: '🌐', status: 'vulnerable', funds: 1.8 },
                { type: 'Paper', security: 'high', icon: '📄', status: 'secure', funds: 25.1 },
                { type: 'Exchange', security: 'low', icon: '🏦', status: 'at-risk', funds: 12.4 }
            ];
            renderWallets();
        }

        function renderBlockchain() {
            const container = document.getElementById('blockchain');
            container.innerHTML = '';
            
            blocks.forEach((block, index) => {
                const blockEl = document.createElement('div');
                blockEl.className = `block ${block.type}`;
                blockEl.innerHTML = `
                    <div>B${block.id}</div>
                    <small>${block.transactions} tx</small>
                `;
                blockEl.title = `Block ${block.id}\nMiner: ${block.miner}\nTransactions: ${block.transactions}\nTime: ${new Date(block.timestamp).toLocaleTimeString()}`;
                container.appendChild(blockEl);
            });
        }

        function renderNetwork() {
            const container = document.getElementById('networkGraph');
            container.innerHTML = '';
            
            // Render connections
            networkNodes.forEach(node => {
                node.connections.forEach(targetId => {
                    const target = networkNodes[targetId];
                    const line = document.createElement('div');
                    line.className = 'connection';
                    
                    const dx = target.x - node.x;
                    const dy = target.y - node.y;
                    const length = Math.sqrt(dx*dx + dy*dy);
                    const angle = Math.atan2(dy, dx);
                    
                    line.style.width = length + 'px';
                    line.style.left = node.x + 'px';
                    line.style.top = node.y + 'px';
                    line.style.transform = `rotate(${angle}rad)`;
                    
                    if (node.type === 'attacker' || target.type === 'attacker') {
                        line.classList.add('malicious');
                    }
                    
                    container.appendChild(line);
                });
            });
            
            // Render nodes
            networkNodes.forEach(node => {
                const nodeEl = document.createElement('div');
                nodeEl.className = `node ${node.type}`;
                nodeEl.style.left = node.x - 22.5 + 'px';
                nodeEl.style.top = node.y - 22.5 + 'px';
                nodeEl.innerHTML = node.id;
                nodeEl.title = `Node ${node.id}\nType: ${node.type}\nStatus: ${node.status}\nHash Rate: ${node.hashRate.toFixed(1)} TH/s`;
                
                nodeEl.addEventListener('click', () => {
                    logMessage(`Inspecting node ${node.id}: ${node.type} node with ${node.hashRate.toFixed(1)} TH/s`, 'info');
                });
                
                container.appendChild(nodeEl);
            });
        }

        function renderMiningPools() {
            const container = document.getElementById('miningPools');
            container.innerHTML = '';
            
            miningPools.forEach((pool, index) => {
                const poolEl = document.createElement('div');
                poolEl.className = 'mining-pool';
                poolEl.innerHTML = `
                    <div class="pool-header">
                        <div class="pool-name">${pool.name}</div>
                        <div class="pool-hashrate">${pool.hashRate}% Hash Rate</div>
                    </div>
                    <div class="miners-list">
                        ${Array(Math.min(pool.miners, 20)).fill().map((_, i) => 
                            `<div class="miner" title="Miner ${i+1}">${i+1}</div>`
                        ).join('')}
                        ${pool.miners > 20 ? `<div style="color: #888; font-size: 0.8em; margin-left: 10px;">+${pool.miners - 20} more</div>` : ''}
                    </div>
                `;
                
                if (pool.type === 'suspicious') {
                    poolEl.style.borderColor = '#ff4757';
                    poolEl.style.background = 'rgba(255, 71, 87, 0.05)';
                }
                
                container.appendChild(poolEl);
            });
        }

        function renderWallets() {
            const container = document.getElementById('walletSecurity');
            container.innerHTML = '';
            
            wallets.forEach(wallet => {
                const walletEl = document.createElement('div');
                walletEl.className = 'wallet-type';
                
                let statusColor = '#2ed573';
                if (wallet.status === 'warning') statusColor = '#ffa502';
                if (wallet.status === 'vulnerable' || wallet.status === 'at-risk') statusColor = '#ff4757';
                
                walletEl.innerHTML = `
                    <div class="wallet-icon">${wallet.icon}</div>
                    <div style="font-weight: bold;">${wallet.type} Wallet</div>
                    <div style="font-size: 0.9em; color: #ccc;">${wallet.funds} BTC</div>
                    <div class="security-level" style="background: ${statusColor};">${wallet.status.toUpperCase()}</div>
                `;
                
                walletEl.addEventListener('click', () => {
                    logMessage(`Wallet scan: ${wallet.type} wallet (${wallet.security} security) - Status: ${wallet.status}`, 'info');
                });
                
                container.appendChild(walletEl);
            });
        }

        function startSimulation() {
            if (!currentAttack) {
                logMessage('Please select an attack type first', 'warning');
                return;
            }
            
            if (isSimulationRunning) {
                logMessage('Simulation already running', 'warning');
                return;
            }
            
            isSimulationRunning = true;
            attackProgress = 0;
            attackerHashPower = 0;
            compromisedBlocks = 0;
            interceptedTx = 0;
            fundsAtRisk = attacks[currentAttack].fundsRisk;
            
            logMessage(`🚀 Initiating ${attacks[currentAttack].title}...`, 'critical');
            logMessage(`⚠️ SECURITY ALERT: Advanced attack simulation in progress`, 'error');
            
            const attack = attacks[currentAttack];
            const duration = attack.duration;
            const targetHashPower = attack.hashPowerRequired;
            
            simulationInterval = setInterval(() => {
                attackProgress += 100 / (duration / 1000);
                
                if (targetHashPower > 0) {
                    attackerHashPower = Math.min(targetHashPower, (attackProgress / 100) * targetHashPower);
                }
                
                // Simulate attack effects based on type
                simulateAttackEffects();
                
                // Update all visualizations
                updateAllStats();
                
                if (attackProgress >= 100) {
                    completeAttack();
                }
            }, 1000);
        }

        function simulateAttackEffects() {
            const attack = attacks[currentAttack];
            const intensity = attackProgress / 100;
            
            switch (currentAttack) {
                case '51attack':
                    if (attackerHashPower > 50 && Math.random() < 0.4) {
                        reorganizeBlockchain();
                        logMessage('🚨 CRITICAL: Blockchain reorganization detected! Double-spend executed', 'critical');
                        interceptedTx += Math.floor(Math.random() * 50) + 10;
                    }
                    break;
                    
                case 'selfish':
                    if (Math.random() < 0.3) {
                        addBlock('withheld');
                        logMessage('📦 Block withheld by selfish miner, honest work wasted', 'error');
                    }
                    break;
                    
                case 'bwh':
                    if (Math.random() < 0.25) {
                        damagePool();
                        logMessage('⛏️ Block withholding attack degrading pool performance', 'warning');
                    }
                    break;
                    
                case 'faw':
                    if (Math.random() < 0.2) {
                        createStrategicFork();
                        logMessage('🍴 Strategic fork created after withholding phase', 'error');
                    }
                    break;
                    
                case 'eclipse':
                    eclipseRandomNode();
                    logMessage('🌑 Node isolated from honest network - eclipse attack in progress', 'error');
                    break;
                    
                case 'sybil':
                    if (Math.random() < 0.15) {
                        addSybilNodes();
                        logMessage('👥 Sybil identities infiltrating network consensus', 'warning');
                    }
                    break;
                    
                case 'dos':
                    if (Math.random() < 0.4) {
                        ddosNode();
                        logMessage('💥 Node overwhelmed by malicious traffic, services degraded', 'error');
                    }
                    break;
                    
                case 'routing':
                    if (Math.random() < 0.1) {
                        hijackTraffic();
                        logMessage('🛣️ BGP hijacking detected - blockchain traffic redirected', 'critical');
                    }
                    break;
                    
                case 'pool-hopping':
                    if (Math.random() < 0.3) {
                        hopPools();
                        logMessage('🏊 Pool hopping detected - miners exploiting reward systems', 'warning');
                    }
                    break;
                    
                case 'reentrancy':
                    if (Math.random() < 0.5) {
                        executeReentrancy();
                        logMessage('🔄 Reentrancy exploit executed - contract funds drained', 'critical');
                    }
                    break;
                    
                case 'flash-loan':
                    if (Math.random() < 0.6) {
                        flashLoanAttack();
                        logMessage('⚡ Flash loan attack manipulating protocol prices', 'critical');
                    }
                    break;
                    
                case 'governance-attack':
                    if (Math.random() < 0.2) {
                        manipulateGovernance();
                        logMessage('🗳️ Governance attack acquiring voting power', 'error');
                    }
                    break;
                    
                default:
                    // Generic attack effects
                    if (Math.random() < 0.2) {
                        logMessage(`🎯 ${attack.title} progressing - network security compromised`, 'warning');
                    }
            }
            
            // Random honest activity
            if (Math.random() < 0.1) {
                addBlock('honest');
                logMessage('✅ Honest block mined and propagated', 'success');
            }
            
            // Random transactions
            if (Math.random() < 0.3) {
                interceptedTx += Math.floor(Math.random() * 5) + 1;
            }
        }

        // Specific attack simulation functions
        function reorganizeBlockchain() {
            blocks.splice(-3);
            for (let i = 0; i < 3; i++) {
                blocks.push({
                    id: blocks.length,
                    type: 'compromised',
                    timestamp: Date.now(),
                    transactions: Math.floor(Math.random() * 1000) + 200,
                    miner: 'Attacker'
                });
            }
            compromisedBlocks += 3;
            renderBlockchain();
        }

        function addBlock(type) {
            blocks.push({
                id: blocks.length,
                type: type,
                timestamp: Date.now(),
                transactions: Math.floor(Math.random() * 1500) + 300,
                miner: type === 'honest' ? `Pool ${Math.floor(Math.random() * 4) + 1}` : 'Attacker'
            });
            
            if (type === 'compromised' || type === 'withheld') {
                compromisedBlocks++;
            }
            
            if (blocks.length > 8) {
                blocks.shift();
            }
            
            renderBlockchain();
        }

        function createStrategicFork() {
            addBlock('forked');
            addBlock('forked');
            logMessage('🍴 Blockchain fork created - network consensus under attack', 'error');
        }

        function damagePool() {
            const pool = miningPools[Math.floor(Math.random() * miningPools.length)];
            pool.hashRate = Math.max(0, pool.hashRate - 2);
            renderMiningPools();
        }

        function eclipseRandomNode() {
            const honestNodes = networkNodes.filter(node => node.type === 'honest');
            if (honestNodes.length > 0) {
                const target = honestNodes[Math.floor(Math.random() * honestNodes.length)];
                target.type = 'victim';
                target.connections = [];
                renderNetwork();
            }
        }

        function addSybilNodes() {
            if (networkNodes.length < 25) {
                const angle = Math.random() * 2 * Math.PI;
                const radius = 80 + Math.random() * 100;
                networkNodes.push({
                    id: networkNodes.length,
                    type: 'sybil',
                    x: Math.cos(angle) * radius + 175,
                    y: Math.sin(angle) * radius + 175,
                    connections: [],
                    status: 'malicious',
                    hashRate: Math.random() * 20
                });
                renderNetwork();
            }
        }

        function ddosNode() {
            const nodes = networkNodes.filter(node => node.status === 'online');
            if (nodes.length > 0) {
                const target = nodes[Math.floor(Math.random() * nodes.length)];
                target.type = 'victim';
                target.status = 'degraded';
                renderNetwork();
            }
        }

        function hijackTraffic() {
            interceptedTx += Math.floor(Math.random() * 100) + 50;
            logMessage('📡 Network traffic intercepted via BGP hijacking', 'critical');
        }

        function hopPools() {
            const miners = document.querySelectorAll('.miner');
            miners.forEach(miner => {
                if (Math.random() < 0.1) {
                    miner.classList.add('hopping');
                }
            });
        }

        function executeReentrancy() {
            fundsAtRisk += Math.floor(Math.random() * 500000) + 100000;
            logMessage('💰 Smart contract vulnerability exploited - funds extracted', 'critical');
        }

        function flashLoanAttack() {
            fundsAtRisk += Math.floor(Math.random() * 2000000) + 500000;
            logMessage('⚡ Flash loan manipulation completed - protocol destabilized', 'critical');
        }

        function manipulateGovernance() {
            logMessage('🗳️ Governance tokens acquired - proposal manipulation in progress', 'error');
        }

        function updateAllStats() {
            document.getElementById('hashpower').textContent = Math.round(attackerHashPower) + '%';
            document.getElementById('blocks').textContent = compromisedBlocks;
            document.getElementById('success').textContent = Math.round(attackProgress) + '%';
            document.getElementById('nodes').textContent = networkNodes.length;
            document.getElementById('transactions').textContent = interceptedTx;
            document.getElementById('funds').textContent = '$' + fundsAtRisk.toLocaleString();
            document.getElementById('progressBar').style.width = attackProgress + '%';
        }

        function completeAttack() {
            clearInterval(simulationInterval);
            isSimulationRunning = false;
            
            const success = attackProgress >= 100;
            if (success) {
                logMessage(`🎯 ${attacks[currentAttack].title} completed successfully!`, 'critical');
                logMessage(`💸 Total impact: $${fundsAtRisk.toLocaleString()} in funds affected`, 'error');
                logMessage(`📊 Attack statistics: ${compromisedBlocks} blocks compromised, ${interceptedTx} transactions intercepted`, 'warning');
            } else {
                logMessage(`🛡️ ${attacks[currentAttack].title} was mitigated`, 'success');
            }
            
            logMessage('📋 Attack simulation completed - generating security report...', 'info');
        }

        function stopSimulation() {
            if (simulationInterval) {
                clearInterval(simulationInterval);
                simulationInterval = null;
                isSimulationRunning = false;
                logMessage('🛑 Attack simulation terminated by security systems', 'warning');
                logMessage('🔒 Network defenses engaged - threat neutralized', 'success');
            }
        }

        function resetNetwork() {
            stopSimulation();
            attackProgress = 0;
            attackerHashPower = 0;
            compromisedBlocks = 0;
            interceptedTx = 0;
            fundsAtRisk = 0;
            
            initializeSimulation();
            
            logMessage('🔄 Network reset completed - all systems restored', 'success');
            logMessage('✅ Security baseline re-established', 'info');
        }

        function scanVulnerabilities() {
            logMessage('🔍 Initiating comprehensive security vulnerability scan...', 'info');
            
            setTimeout(() => {
                const vulnerabilities = [
                    { level: 'critical', title: 'Weak Consensus Mechanism', description: 'Network vulnerable to 51% attacks due to centralized mining' },
                    { level: 'critical', title: 'Smart Contract Reentrancy', description: 'Multiple contracts lack proper reentrancy protection' },
                    { level: 'high', title: 'Insufficient Node Diversity', description: 'Geographic concentration increases eclipse attack risk' },
                    { level: 'high', title: 'Weak Governance Security', description: 'Governance tokens concentrated in few wallets' },
                    { level: 'medium', title: 'Pool Centralization', description: 'Top 3 pools control >60% of hash power' },
                    { level: 'medium', title: 'BGP Vulnerability', description: 'Network traffic not sufficiently protected against routing attacks' },
                    { level: 'low', title: 'Outdated Protocol', description: 'Some nodes running older protocol versions' },
                    { level: 'low', title: 'Wallet Security', description: 'Users storing funds in low-security wallets' }
                ];
                
                vulnerabilities.forEach((vuln, index) => {
                    setTimeout(() => {
                        logMessage(`🚨 ${vuln.level.toUpperCase()}: ${vuln.title} - ${vuln.description}`, vuln.level === 'critical' ? 'critical' : vuln.level === 'high' ? 'error' : 'warning');
                    }, index * 500);
                });
                
                setTimeout(() => {
                    logMessage(`📊 Vulnerability scan completed: ${vulnerabilities.length} issues identified`, 'warning');
                    logMessage('🛡️ Recommend immediate security improvements', 'info');
                }, vulnerabilities.length * 500 + 1000);
            }, 2000);
        }

        function deployDefenses() {
            logMessage('🛡️ Deploying advanced security countermeasures...', 'info');
            
            const defenses = [
                'Multi-signature validation enabled',
                'Rate limiting activated on all nodes',
                'BGP monitoring systems online',
                'Smart contract circuit breakers deployed',
                'Enhanced peer diversity enforcement',
                'Flash loan detection algorithms active',
                'Governance attack prevention protocols enabled'
            ];
            
            defenses.forEach((defense, index) => {
                setTimeout(() => {
                    logMessage(`✅ ${defense}`, 'success');
                }, index * 800);
            });
            
            setTimeout(() => {
                logMessage('🔒 All security systems operational - network hardened', 'success');
            }, defenses.length * 800 + 500);
        }

        function analyzeTraffic() {
            logMessage('📊 Analyzing network traffic patterns...', 'info');
            
            setTimeout(() => {
                const patterns = [
                    'Suspicious connection patterns detected from 15 IP addresses',
                    'Abnormal transaction volume spike detected (+340%)',
                    'Potential Sybil nodes identified in peer network',
                    'Mining pool switching behavior suggests pool hopping',
                    'Smart contract interactions show MEV extraction patterns',
                    'Governance token movements indicate potential attack preparation'
                ];
                
                patterns.forEach((pattern, index) => {
                    setTimeout(() => {
                        logMessage(`🔍 ANALYSIS: ${pattern}`, 'warning');
                    }, index * 600);
                });
                
                setTimeout(() => {
                    logMessage('📈 Traffic analysis complete - threat indicators identified', 'info');
                    logMessage('🚨 Recommend heightened security monitoring', 'warning');
                }, patterns.length * 600 + 1000);
            }, 1500);
        }

        function castVote(proposalId) {
            const proposals = document.querySelectorAll('.vote-option');
            const clicked = proposals[proposalId];
            logMessage(`🗳️ Vote cast on proposal ${proposalId + 1}`, 'info');
            
            // Simulate vote manipulation
            if (currentAttack === 'vote-buying' || currentAttack === 'governance-attack') {
                logMessage(`⚠️ Vote manipulation detected - governance attack in progress`, 'error');
            }
        }

        function logMessage(message, type = 'info') {
            const logs = document.getElementById('logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            logs.appendChild(logEntry);
            logs.scrollTop = logs.scrollHeight;
            
            // Limit log entries
            if (logs.children.length > 100) {
                logs.removeChild(logs.firstChild);
            }
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('attackModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Add some ambient effects
        setInterval(() => {
            if (!isSimulationRunning && Math.random() < 0.1) {
                const messages = [
                    'Network heartbeat normal - all systems operational',
                    'Blockchain synchronization complete',
                    'Peer connections stable across all nodes',
                    'Mining difficulty adjustment scheduled',
                    'Smart contract executions proceeding normally'
                ];
                logMessage(messages[Math.floor(Math.random() * messages.length)], 'success');
            }
        }, 10000);
    </script>
</body>
</html>