<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Blockchain Simulator Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: radial-gradient(ellipse at top, #1e1b4b 0%, #0f172a 100%);
            color: #f8fafc;
            min-height: 100vh;
            overflow-x: auto;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 100vh;
        }

        .sidebar {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(148, 163, 184, 0.1);
            padding: 20px;
            overflow-y: auto;
        }

        .main-content {
            padding: 20px;
            overflow-y: auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, #06b6d4, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
            text-align: center;
        }

        .nav-section {
            margin-bottom: 25px;
        }

        .nav-title {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 4px;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
        }

        .nav-item.active {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
        }

        .nav-icon {
            margin-right: 10px;
            font-size: 1rem;
        }

        .header {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, #06b6d4, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .header p {
            color: #94a3b8;
            font-size: 1.1rem;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 25px;
        }

        .metric-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(148, 163, 184, 0.1);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 800;
            color: #06b6d4;
            margin-bottom: 4px;
        }

        .metric-label {
            color: #94a3b8;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .metric-change {
            font-size: 0.8rem;
            color: #10b981;
        }

        .panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(148, 163, 184, 0.1);
            display: none;
        }

        .panel.active {
            display: block;
        }

        .panel-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .panel-icon {
            margin-right: 10px;
            font-size: 1.3rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-weight: 500;
            color: #e2e8f0;
            margin-bottom: 6px;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 8px;
            color: #f1f5f9;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-input::placeholder {
            color: #64748b;
        }

        .btn {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #64748b, #475569);
        }

        .btn-danger {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }

        .blockchain-viz {
            background: rgba(30, 41, 59, 0.4);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 400px;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .block-node {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .block-node:hover {
            filter: brightness(1.2);
        }

        .block-text {
            fill: white;
            font-size: 10px;
            font-weight: 600;
            text-anchor: middle;
            dominant-baseline: middle;
        }

        .link {
            stroke: #06b6d4;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }

        .merkle-tree {
            background: rgba(30, 41, 59, 0.4);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .merkle-node {
            fill: #1e293b;
            stroke: #06b6d4;
            stroke-width: 2;
            cursor: pointer;
        }

        .merkle-node:hover {
            fill: #334155;
        }

        .merkle-text {
            fill: white;
            font-size: 10px;
            text-anchor: middle;
            dominant-baseline: middle;
        }

        .transaction-pool {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(30, 41, 59, 0.4);
            border-radius: 8px;
            padding: 15px;
        }

        .transaction-item {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            font-size: 0.8rem;
        }

        .mining-progress {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(148, 163, 184, 0.1);
            display: none;
        }

        .mining-progress.active {
            display: block;
        }

        .progress-bar {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 20px;
            overflow: hidden;
            height: 8px;
            margin: 15px 0;
        }

        .progress-fill {
            background: linear-gradient(45deg, #06b6d4, #8b5cf6);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .hash-display {
            font-family: 'Monaco', 'Menlo', monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.7rem;
            color: #06b6d4;
            word-break: break-all;
            margin: 8px 0;
        }

        .block-details {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(148, 163, 184, 0.1);
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #94a3b8;
        }

        .detail-value {
            color: #f1f5f9;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
        }

        .log-panel {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .log-entry {
            margin-bottom: 4px;
            opacity: 0.9;
        }

        .log-entry.success { color: #10b981; }
        .log-entry.error { color: #ef4444; }
        .log-entry.info { color: #06b6d4; }
        .log-entry.warning { color: #f59e0b; }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #06b6d4;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            pointer-events: none;
            z-index: 1000;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-valid { background: #10b981; }
        .status-invalid { background: #ef4444; }
        .status-mining { background: #f59e0b; animation: pulse 2s infinite; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(148, 163, 184, 0.2);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .tab:hover {
            color: #06b6d4;
        }

        .tab.active {
            color: #06b6d4;
            border-bottom-color: #06b6d4;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="sidebar">
            <div class="logo">🔗 Blockchain Pro</div>
            
            <div class="nav-section">
                <div class="nav-title">Overview</div>
                <div class="nav-item active" data-panel="dashboard">
                    <span class="nav-icon">📊</span>
                    Dashboard
                </div>
                <div class="nav-item" data-panel="network">
                    <span class="nav-icon">🌐</span>
                    Network View
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Transactions</div>
                <div class="nav-item" data-panel="transactions">
                    <span class="nav-icon">💸</span>
                    Create Transaction
                </div>
                <div class="nav-item" data-panel="pool">
                    <span class="nav-icon">🏊</span>
                    Transaction Pool
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Mining</div>
                <div class="nav-item" data-panel="mining">
                    <span class="nav-icon">⛏️</span>
                    Mining Control
                </div>
                <div class="nav-item" data-panel="miners">
                    <span class="nav-icon">👥</span>
                    Miners
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">Analysis</div>
                <div class="nav-item" data-panel="explorer">
                    <span class="nav-icon">🔍</span>
                    Block Explorer
                </div>
                <div class="nav-item" data-panel="validation">
                    <span class="nav-icon">✅</span>
                    Validation
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>Advanced Blockchain Simulator</h1>
                <p>Professional-grade blockchain development and testing environment</p>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value" id="totalBlocks">1</div>
                    <div class="metric-label">Total Blocks</div>
                    <div class="metric-change">+0 this session</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="totalTransactions">0</div>
                    <div class="metric-label">Total Transactions</div>
                    <div class="metric-change">+0 this session</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="pendingTransactions">0</div>
                    <div class="metric-label">Pending Transactions</div>
                    <div class="metric-change">Ready to mine</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="hashRate">0</div>
                    <div class="metric-label">Hash Rate (H/s)</div>
                    <div class="metric-change">Current session</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value" id="difficulty">4</div>
                    <div class="metric-label">Mining Difficulty</div>
                    <div class="metric-change">Leading zeros required</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">
                        <span class="status-indicator status-valid"></span>
                        <span id="chainStatus">Valid</span>
                    </div>
                    <div class="metric-label">Chain Status</div>
                    <div class="metric-change">All blocks verified</div>
                </div>
            </div>

            <!-- Dashboard Panel -->
            <div class="panel active" id="dashboard">
                <div class="panel-title">
                    <span class="panel-icon">📊</span>
                    Blockchain Overview
                </div>
                <div class="blockchain-viz" id="blockchainViz"></div>
                <div class="log-panel" id="logPanel">
                    <div class="log-entry info">[INIT] Blockchain simulator initialized successfully</div>
                </div>
            </div>

            <!-- Network View Panel -->
            <div class="panel" id="network">
                <div class="panel-title">
                    <span class="panel-icon">🌐</span>
                    Network Visualization
                </div>
                <div class="tabs">
                    <div class="tab active" data-tab="blockchain-graph">Blockchain Graph</div>
                    <div class="tab" data-tab="merkle-tree">Merkle Tree</div>
                </div>
                <div class="tab-content active" id="blockchain-graph">
                    <div class="blockchain-viz" id="networkGraph"></div>
                </div>
                <div class="tab-content" id="merkle-tree">
                    <div class="merkle-tree" id="merkleTree"></div>
                </div>
            </div>

            <!-- Transactions Panel -->
            <div class="panel" id="transactions">
                <div class="panel-title">
                    <span class="panel-icon">💸</span>
                    Create Transaction
                </div>
                <div class="form-grid">
                    <div>
                        <div class="form-group">
                            <label class="form-label">From Address</label>
                            <input type="text" class="form-input" id="senderAddress" placeholder="Enter sender address">
                        </div>
                        <div class="form-group">
                            <label class="form-label">To Address</label>
                            <input type="text" class="form-input" id="receiverAddress" placeholder="Enter receiver address">
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label class="form-label">Amount</label>
                            <input type="number" class="form-input" id="transactionAmount" placeholder="0.00" step="0.01" min="0.01">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Transaction Fee</label>
                            <input type="number" class="form-input" id="transactionFee" placeholder="0.001" step="0.001" value="0.001">
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="createTransaction()">Create Transaction</button>
            </div>

            <!-- Transaction Pool Panel -->
            <div class="panel" id="pool">
                <div class="panel-title">
                    <span class="panel-icon">🏊</span>
                    Transaction Pool
                </div>
                <div class="transaction-pool" id="transactionPool">
                    <div style="text-align: center; color: #64748b; padding: 40px;">
                        No pending transactions
                    </div>
                </div>
            </div>

            <!-- Mining Panel -->
            <div class="panel" id="mining">
                <div class="panel-title">
                    <span class="panel-icon">⛏️</span>
                    Mining Control
                </div>
                
                <div class="mining-progress" id="miningProgress">
                    <div style="display: flex; align-items: center; margin-bottom: 15px;">
                        <div class="spinner"></div>
                        <span>Mining Block <span id="miningBlockIndex"></span>...</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="miningProgressFill"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #94a3b8;">
                        <span>Nonce: <span id="currentNonce">0</span></span>
                        <span>Hash Rate: <span id="currentHashRate">0</span> H/s</span>
                        <span>Elapsed: <span id="miningTime">0</span>s</span>
                    </div>
                </div>

                <div class="form-grid">
                    <div>
                        <div class="form-group">
                            <label class="form-label">Miner Address</label>
                            <input type="text" class="form-input" id="minerAddress" value="Miner_Alpha" placeholder="Enter miner address">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Mining Difficulty</label>
                            <select class="form-input" id="difficultySelect" onchange="updateDifficulty()">
                                <option value="1">1 - Very Easy</option>
                                <option value="2">2 - Easy</option>
                                <option value="3">3 - Medium</option>
                                <option value="4" selected>4 - Hard</option>
                                <option value="5">5 - Very Hard</option>
                                <option value="6">6 - Extreme</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <div class="form-group">
                            <label class="form-label">Block Reward</label>
                            <input type="number" class="form-input" id="blockReward" value="10" step="0.1" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Auto-mine</label>
                            <select class="form-input" id="autoMine">
                                <option value="false">Disabled</option>
                                <option value="true">Enabled</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn" id="mineButton" onclick="mineBlock()">Mine Block</button>
                    <button class="btn btn-secondary" onclick="stopMining()">Stop Mining</button>
                </div>
            </div>

            <!-- Miners Panel -->
            <div class="panel" id="miners">
                <div class="panel-title">
                    <span class="panel-icon">👥</span>
                    Active Miners
                </div>
                <div id="minersPanel">
                    <div style="text-align: center; color: #64748b; padding: 40px;">
                        No active miners
                    </div>
                </div>
            </div>

            <!-- Block Explorer Panel -->
            <div class="panel" id="explorer">
                <div class="panel-title">
                    <span class="panel-icon">🔍</span>
                    Block Explorer
                </div>
                <div class="form-group">
                    <label class="form-label">Search by Block Index or Hash</label>
                    <input type="text" class="form-input" id="searchInput" placeholder="Enter block index or hash">
                </div>
                <button class="btn" onclick="searchBlock()">Search Block</button>
                <div class="block-details" id="blockDetails" style="display: none;">
                    <!-- Block details will be displayed here -->
                </div>
            </div>

            <!-- Validation Panel -->
            <div class="panel" id="validation">
                <div class="panel-title">
                    <span class="panel-icon">✅</span>
                    Chain Validation & Tools
                </div>
                <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                    <button class="btn" onclick="validateChain()">Validate Chain</button>
                    <button class="btn btn-secondary" onclick="exportBlockchain()">Export JSON</button>
                    <button class="btn btn-danger" onclick="resetBlockchain()">Reset Chain</button>
                </div>
                <div id="validationResults"></div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Blockchain Implementation
        class MerkleTree {
            constructor(transactions) {
                this.transactions = transactions;
                this.root = this.buildMerkleTree(transactions);
                this.tree = [];
            }

            buildMerkleTree(transactions) {
                if (!transactions || transactions.length === 0) {
                    return this.sha256("NO_TRANSACTIONS");
                }

                let hashes = transactions.map(tx => this.hashTransaction(tx));
                this.tree = [hashes.slice()]; // Store first level

                while (hashes.length > 1) {
                    if (hashes.length % 2 === 1) {
                        hashes.push(hashes[hashes.length - 1]);
                    }
                    
                    const newLevel = [];
                    for (let i = 0; i < hashes.length; i += 2) {
                        newLevel.push(this.hashPair(hashes[i], hashes[i + 1]));
                    }
                    
                    this.tree.push(newLevel.slice());
                    hashes = newLevel;
                }

                return hashes[0];
            }

            hashTransaction(transaction) {
                return this.sha256(JSON.stringify(transaction));
            }

            hashPair(hash1, hash2) {
                return this.sha256(hash1 + hash2);
            }

            sha256(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16).padStart(16, '0');
            }
        }

        class Transaction {
            constructor(sender, receiver, amount, fee = 0.001) {
                this.sender = sender;
                this.receiver = receiver;
                this.amount = parseFloat(amount);
                this.fee = parseFloat(fee);
                this.timestamp = Date.now();
                this.id = this.generateId();
            }

            generateId() {
                const data = `${this.sender}${this.receiver}${this.amount}${this.timestamp}`;
                return this.sha256(data).substring(0, 16);
            }

            toDict() {
                return {
                    id: this.id,
                    sender: this.sender,
                    receiver: this.receiver,
                    amount: this.amount,
                    fee: this.fee,
                    timestamp: this.timestamp
                };
            }

            toString() {
                return JSON.stringify(this.toDict());
            }

            sha256(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16).padStart(16, '0');
            }
        }

        class Block {
            constructor(index, previousHash, transactions, nonce = 0) {
                this.index = index;
                this.timestamp = Date.now();
                this.previousHash = previousHash;
                this.transactions = transactions || [];
                this.merkleTree = new MerkleTree(this.transactions.map(tx => tx.toString()));
                this.merkleRoot = this.merkleTree.root;
                this.nonce = nonce;
                this.hash = this.calculateHash();
            }

            calculateHash() {
                const blockString = JSON.stringify({
                    index: this.index,
                    timestamp: this.timestamp,
                    previousHash: this.previousHash,
                    merkleRoot: this.merkleRoot,
                    nonce: this.nonce
                });
                return this.sha256(blockString);
            }

            async mineBlock(difficulty, onProgress) {
                const target = '0'.repeat(difficulty);
                let attempts = 0;
                const startTime = Date.now();

                return new Promise((resolve) => {
                    const mineStep = () => {
                        const stepStart = Date.now();
                        
                        while (Date.now() - stepStart < 50) { // 50ms chunks
                            this.nonce++;
                            attempts++;
                            this.hash = this.calculateHash();
                            
                            if (this.hash.startsWith(target)) {
                                const endTime = Date.now();
                                const hashRate = Math.round(attempts / ((endTime - startTime) / 1000));
                                resolve({ attempts, hashRate, time: (endTime - startTime) / 1000 });
                                return;
                            }
                        }
                        
                        if (onProgress) {
                            const currentTime = (Date.now() - startTime) / 1000;
                            const currentHashRate = Math.round(attempts / currentTime);
                            onProgress(this.nonce, attempts, currentHashRate, currentTime);
                        }
                        
                        setTimeout(mineStep, 1);
                    };
                    
                    mineStep();
                });
            }

            sha256(str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16).padStart(16, '0');
            }
        }

        class Blockchain {
            constructor(difficulty = 4) {
                this.chain = [this.createGenesisBlock()];
                this.pendingTransactions = [];
                this.difficulty = difficulty;
                this.blockReward = 10;
                this.miners = new Map();
            }

            createGenesisBlock() {
                const genesis = new Block(0, "0", []);
                genesis.hash = genesis.calculateHash();
                return genesis;
            }

            addTransaction(transaction) {
                if (!(transaction instanceof Transaction)) {
                    throw new Error("Invalid transaction object");
                }
                this.pendingTransactions.push(transaction);
            }

            async minePendingTransactions(minerAddress, onProgress) {
                if (this.pendingTransactions.length === 0) {
                    throw new Error("No pending transactions to mine");
                }

                const rewardTransaction = new Transaction("NETWORK", minerAddress, this.blockReward, 0);
                const transactions = [...this.pendingTransactions, rewardTransaction];
                
                const newBlock = new Block(
                    this.chain.length,
                    this.chain[this.chain.length - 1].hash,
                    transactions
                );

                const miningResult = await newBlock.mineBlock(this.difficulty, onProgress);
                this.chain.push(newBlock);
                this.pendingTransactions = [];

                // Update miner stats
                if (!this.miners.has(minerAddress)) {
                    this.miners.set(minerAddress, { blocksMinedged: 0, totalRewards: 0 });
                }
                const minerStats = this.miners.get(minerAddress);
                minerStats.blocksMined = (minerStats.blocksMined || 0) + 1;
                minerStats.totalRewards = (minerStats.totalRewards || 0) + this.blockReward;

                return miningResult;
            }

            isChainValid() {
                for (let i = 1; i < this.chain.length; i++) {
                    const currentBlock = this.chain[i];
                    const previousBlock = this.chain[i - 1];

                    if (currentBlock.hash !== currentBlock.calculateHash()) {
                        return { valid: false, error: `Block ${i} hash has been tampered with` };
                    }

                    if (currentBlock.previousHash !== previousBlock.hash) {
                        return { valid: false, error: `Block ${i} has invalid previous hash` };
                    }

                    // Validate merkle tree
                    const merkleTree = new MerkleTree(currentBlock.transactions.map(tx => tx.toString()));
                    if (currentBlock.merkleRoot !== merkleTree.root) {
                        return { valid: false, error: `Block ${i} has invalid merkle root` };
                    }
                    
                    // Validate difficulty
                    if (!currentBlock.hash.startsWith('0'.repeat(this.difficulty))) {
                        return { valid: false, error: `Block ${i} doesn't meet difficulty requirement` };
                    }
                }
                return { valid: true };
            }

            getBlock(indexOrHash) {
                if (typeof indexOrHash === 'number') {
                    return this.chain[indexOrHash] || null;
                }
                return this.chain.find(block => block.hash === indexOrHash) || null;
            }

            getTotalTransactions() {
                return this.chain.reduce((total, block) => total + block.transactions.length, 0);
            }
        }

        // Global state
        let blockchain = new Blockchain();
        let isMining = false;
        let currentHashRate = 0;
        let autoMineEnabled = false;

        // UI Management
        const panels = {
            dashboard: document.getElementById('dashboard'),
            network: document.getElementById('network'),
            transactions: document.getElementById('transactions'),
            pool: document.getElementById('pool'),
            mining: document.getElementById('mining'),
            miners: document.getElementById('miners'),
            explorer: document.getElementById('explorer'),
            validation: document.getElementById('validation')
        };

        function showPanel(panelName) {
            // Hide all panels
            Object.values(panels).forEach(panel => panel.classList.remove('active'));
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            
            // Show selected panel
            panels[panelName].classList.add('active');
            
            // Add active class to clicked nav item
            document.querySelector(`[data-panel="${panelName}"]`).classList.add('active');

            // Refresh panel content
            refreshPanelContent(panelName);
        }

        function refreshPanelContent(panelName) {
            switch(panelName) {
                case 'dashboard':
                    renderBlockchainVisualization();
                    break;
                case 'network':
                    renderNetworkGraph();
                    break;
                case 'pool':
                    renderTransactionPool();
                    break;
                case 'miners':
                    renderMinersPanel();
                    break;
            }
        }

        // Event listeners for navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                const panel = item.getAttribute('data-panel');
                showPanel(panel);
            });
        });

        // Tab functionality
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                const parent = tab.closest('.panel');
                
                // Remove active class from all tabs and content in this panel
                parent.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                parent.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                parent.querySelector(`#${tabId}`).classList.add('active');

                // Refresh content
                if (tabId === 'blockchain-graph') {
                    renderNetworkGraph();
                } else if (tabId === 'merkle-tree') {
                    renderMerkleTree();
                }
            });
        });

        function logMessage(message, type = 'info') {
            const logPanel = document.getElementById('logPanel');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logPanel.appendChild(logEntry);
            logPanel.scrollTop = logPanel.scrollHeight;
        }

        function updateMetrics() {
            document.getElementById('totalBlocks').textContent = blockchain.chain.length;
            document.getElementById('totalTransactions').textContent = blockchain.getTotalTransactions();
            document.getElementById('pendingTransactions').textContent = blockchain.pendingTransactions.length;
            document.getElementById('hashRate').textContent = currentHashRate;
            document.getElementById('difficulty').textContent = blockchain.difficulty;
            
            const validation = blockchain.isChainValid();
            const statusElement = document.getElementById('chainStatus');
            const statusIndicator = statusElement.previousElementSibling;
            
            if (validation.valid) {
                statusElement.textContent = 'Valid';
                statusIndicator.className = 'status-indicator status-valid';
            } else {
                statusElement.textContent = 'Invalid';
                statusIndicator.className = 'status-indicator status-invalid';
            }
        }

        function renderBlockchainVisualization() {
            const container = document.getElementById('blockchainViz');
            container.innerHTML = '';

            const width = container.offsetWidth;
            const height = 400;

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            // Define arrow marker
            svg.append('defs').append('marker')
                .attr('id', 'arrowhead')
                .attr('viewBox', '0 -5 10 10')
                .attr('refX', 8)
                .attr('refY', 0)
                .attr('markerWidth', 6)
                .attr('markerHeight', 6)
                .attr('orient', 'auto')
                .append('path')
                .attr('d', 'M0,-5L10,0L0,5')
                .attr('fill', '#06b6d4');

            const blockWidth = 120;
            const blockHeight = 80;
            const spacing = 150;

            blockchain.chain.forEach((block, index) => {
                const x = index * spacing + 50;
                const y = height / 2 - blockHeight / 2;

                // Block rectangle
                const blockColor = index === 0 ? '#ef4444' : '#3b82f6';
                const rect = svg.append('rect')
                    .attr('x', x)
                    .attr('y', y)
                    .attr('width', blockWidth)
                    .attr('height', blockHeight)
                    .attr('fill', blockColor)
                    .attr('stroke', '#06b6d4')
                    .attr('stroke-width', 2)
                    .attr('rx', 8)
                    .attr('class', 'block-node')
                    .on('click', () => displayBlockDetails(block));

                // Block text
                svg.append('text')
                    .attr('x', x + blockWidth / 2)
                    .attr('y', y + 20)
                    .attr('class', 'block-text')
                    .text(`Block ${index}`);

                svg.append('text')
                    .attr('x', x + blockWidth / 2)
                    .attr('y', y + 35)
                    .attr('class', 'block-text')
                    .style('font-size', '8px')
                    .text(`Hash: ${block.hash.substring(0, 8)}...`);

                svg.append('text')
                    .attr('x', x + blockWidth / 2)
                    .attr('y', y + 50)
                    .attr('class', 'block-text')
                    .style('font-size', '8px')
                    .text(`Txs: ${block.transactions.length}`);

                svg.append('text')
                    .attr('x', x + blockWidth / 2)
                    .attr('y', y + 65)
                    .attr('class', 'block-text')
                    .style('font-size', '8px')
                    .text(`Nonce: ${block.nonce}`);

                // Arrow to next block
                if (index < blockchain.chain.length - 1) {
                    svg.append('line')
                        .attr('x1', x + blockWidth)
                        .attr('y1', y + blockHeight / 2)
                        .attr('x2', x + spacing)
                        .attr('y2', y + blockHeight / 2)
                        .attr('class', 'link');
                }
            });
        }

        function renderNetworkGraph() {
            const container = document.getElementById('networkGraph');
            container.innerHTML = '';

            const width = container.offsetWidth;
            const height = 400;

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const nodes = blockchain.chain.map(block => ({
                id: block.index,
                hash: block.hash,
                transactions: block.transactions.length,
                merkleRoot: block.merkleRoot,
                nonce: block.nonce
            }));

            const links = blockchain.chain.slice(1).map(block => ({
                source: block.index - 1,
                target: block.index
            }));

            const simulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id).distance(150))
                .force('charge', d3.forceManyBody().strength(-300))
                .force('center', d3.forceCenter(width / 2, height / 2));

            const link = svg.append('g')
                .selectAll('line')
                .data(links)
                .enter().append('line')
                .attr('stroke', '#06b6d4')
                .attr('stroke-width', 3)
                .attr('marker-end', 'url(#arrowhead)');

            const node = svg.append('g')
                .selectAll('circle')
                .data(nodes)
                .enter().append('circle')
                .attr('r', 30)
                .attr('fill', d => d.id === 0 ? '#ef4444' : '#3b82f6')
                .attr('stroke', '#06b6d4')
                .attr('stroke-width', 2)
                .call(d3.drag()
                    .on('start', dragstarted)
                    .on('drag', dragged)
                    .on('end', dragended))
                .on('click', (event, d) => {
                    const block = blockchain.getBlock(d.id);
                    displayBlockDetails(block);
                });

            const text = svg.append('g')
                .selectAll('text')
                .data(nodes)
                .enter().append('text')
                .attr('text-anchor', 'middle')
                .attr('dominant-baseline', 'middle')
                .attr('fill', 'white')
                .attr('font-size', '12px')
                .attr('font-weight', 'bold')
                .text(d => d.id);

            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                node
                    .attr('cx', d => d.x)
                    .attr('cy', d => d.y);

                text
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });

            function dragstarted(event, d) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x;
                d.fy = d.y;
            }

            function dragged(event, d) {
                d.fx = event.x;
                d.fy = event.y;
            }

            function dragended(event, d) {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null;
                d.fy = null;
            }
        }

        function renderMerkleTree() {
            const container = document.getElementById('merkleTree');
            container.innerHTML = '';

            if (blockchain.chain.length === 0) return;

            const lastBlock = blockchain.chain[blockchain.chain.length - 1];
            if (!lastBlock.merkleTree || lastBlock.merkleTree.tree.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #64748b; padding: 40px;">No transactions in latest block</div>';
                return;
            }

            const width = container.offsetWidth;
            const height = 300;

            const svg = d3.select(container)
                .append('svg')
                .attr('width', width)
                .attr('height', height);

            const tree = lastBlock.merkleTree.tree;
            const levels = tree.length;
            const levelHeight = height / (levels + 1);

            tree.forEach((level, levelIndex) => {
                const nodeWidth = width / (level.length + 1);
                
                level.forEach((hash, nodeIndex) => {
                    const x = (nodeIndex + 1) * nodeWidth;
                    const y = (levelIndex + 1) * levelHeight;

                    // Node circle
                    svg.append('circle')
                        .attr('cx', x)
                        .attr('cy', y)
                        .attr('r', 20)
                        .attr('class', 'merkle-node')
                        .on('click', () => {
                            alert(`Hash: ${hash}\nLevel: ${levelIndex}\nPosition: ${nodeIndex}`);
                        });

                    // Node text
                    svg.append('text')
                        .attr('x', x)
                        .attr('y', y)
                        .attr('class', 'merkle-text')
                        .text(hash.substring(0, 4));

                    // Connect to parent (if not root level)
                    if (levelIndex < levels - 1) {
                        const parentIndex = Math.floor(nodeIndex / 2);
                        const parentX = (parentIndex + 1) * (width / (tree[levelIndex + 1].length + 1));
                        const parentY = (levelIndex + 2) * levelHeight;

                        svg.append('line')
                            .attr('x1', x)
                            .attr('y1', y)
                            .attr('x2', parentX)
                            .attr('y2', parentY)
                            .attr('stroke', '#06b6d4')
                            .attr('stroke-width', 1);
                    }
                });
            });
        }

        function renderTransactionPool() {
            const container = document.getElementById('transactionPool');
            
            if (blockchain.pendingTransactions.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #64748b; padding: 40px;">No pending transactions</div>';
                return;
            }

            container.innerHTML = blockchain.pendingTransactions.map(tx => `
                <div class="transaction-item">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                        <span style="font-weight: 600;">TX: ${tx.id}</span>
                        <span style="color: #06b6d4;">$${tx.amount}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.7rem; color: #94a3b8;">
                        <span>${tx.sender} → ${tx.receiver}</span>
                        <span>Fee: $${tx.fee}</span>
                    </div>
                    <div style="font-size: 0.7rem; color: #64748b; margin-top: 4px;">
                        ${new Date(tx.timestamp).toLocaleString()}
                    </div>
                </div>
            `).join('');
        }

        function renderMinersPanel() {
            const container = document.getElementById('minersPanel');
            
            if (blockchain.miners.size === 0) {
                container.innerHTML = '<div style="text-align: center; color: #64748b; padding: 40px;">No active miners</div>';
                return;
            }

            const minersHtml = Array.from(blockchain.miners.entries()).map(([address, stats]) => `
                <div class="metric-card" style="margin-bottom: 15px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span style="font-weight: 600;">${address}</span>
                        <span class="status-indicator ${isMining ? 'status-mining' : 'status-valid'}"></span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.8rem;">
                        <div>Blocks Mined: <span style="color: #06b6d4;">${stats.blocksMined || 0}</span></div>
                        <div>Total Rewards: <span style="color: #10b981;">$${stats.totalRewards || 0}</span></div>
                    </div>
                </div>
            `).join('');

            container.innerHTML = minersHtml;
        }

        function displayBlockDetails(block) {
            const container = document.getElementById('blockDetails');
            container.style.display = 'block';
            
            container.innerHTML = `
                <div class="panel-title" style="margin-bottom: 20px;">
                    <span class="panel-icon">📦</span>
                    Block ${block.index} Details
                </div>
                <div class="detail-row">
                    <span class="detail-label">Index:</span>
                    <span class="detail-value">${block.index}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Hash:</span>
                    <span class="detail-value">${block.hash}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Previous Hash:</span>
                    <span class="detail-value">${block.previousHash}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Merkle Root:</span>
                    <span class="detail-value">${block.merkleRoot}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Timestamp:</span>
                    <span class="detail-value">${new Date(block.timestamp).toLocaleString()}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Nonce:</span>
                    <span class="detail-value">${block.nonce}</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Transactions:</span>
                    <span class="detail-value">${block.transactions.length}</span>
                </div>
                ${block.transactions.length > 0 ? `
                    <div style="margin-top: 20px;">
                        <div class="detail-label" style="margin-bottom: 10px;">Transaction List:</div>
                        ${block.transactions.map(tx => `
                            <div class="transaction-item" style="margin-bottom: 8px;">
                                <div><strong>ID:</strong> ${tx.id}</div>
                                <div><strong>From:</strong> ${tx.sender} <strong>To:</strong> ${tx.receiver}</div>
                                <div><strong>Amount:</strong> $${tx.amount} <strong>Fee:</strong> $${tx.fee}</div>
                            </div>
                        `).join('')}
                    </div>
                ` : ''}
            `;
            
            // Scroll to block details
            container.scrollIntoView({ behavior: 'smooth' });
        }

        // Core Functions
        function createTransaction() {
            try {
                const sender = document.getElementById('senderAddress').value.trim();
                const receiver = document.getElementById('receiverAddress').value.trim();
                const amount = parseFloat(document.getElementById('transactionAmount').value);
                const fee = parseFloat(document.getElementById('transactionFee').value) || 0.001;

                if (!sender || !receiver) {
                    throw new Error("Please enter both sender and receiver addresses");
                }

                if (!amount || amount <= 0) {
                    throw new Error("Please enter a valid positive amount");
                }

                const transaction = new Transaction(sender, receiver, amount, fee);
                blockchain.addTransaction(transaction);

                logMessage(`Transaction created: ${sender} → ${receiver} ($${amount})`, 'success');

                // Clear form
                document.getElementById('senderAddress').value = '';
                document.getElementById('receiverAddress').value = '';
                document.getElementById('transactionAmount').value = '';

                updateMetrics();
                renderTransactionPool();

                // Auto-mine if enabled
                if (autoMineEnabled && !isMining) {
                    setTimeout(() => mineBlock(), 1000);
                }

            } catch (error) {
                logMessage(`Transaction error: ${error.message}`, 'error');
            }
        }

        async function mineBlock() {
            if (isMining) return;

            if (blockchain.pendingTransactions.length === 0) {
                logMessage("No pending transactions to mine", 'warning');
                return;
            }

            isMining = true;
            const minerAddress = document.getElementById('minerAddress').value.trim() || 'Miner_Alpha';
            const mineButton = document.getElementById('mineButton');
            const miningProgress = document.getElementById('miningProgress');

            mineButton.disabled = true;
            mineButton.textContent = 'Mining...';
            miningProgress.classList.add('active');

            document.getElementById('miningBlockIndex').textContent = blockchain.chain.length;

            try {
                logMessage(`Started mining block ${blockchain.chain.length} (Miner: ${minerAddress})`, 'info');
                
                const result = await blockchain.minePendingTransactions(minerAddress, (nonce, attempts, hashRate, time) => {
                    document.getElementById('currentNonce').textContent = nonce;
                    document.getElementById('currentHashRate').textContent = hashRate;
                    document.getElementById('miningTime').textContent = time.toFixed(1);
                    document.getElementById('miningProgressFill').style.width = `${Math.min(time * 10, 95)}%`;
                    currentHashRate = hashRate;
                });

                document.getElementById('miningProgressFill').style.width = '100%';
                currentHashRate = result.hashRate;

                logMessage(`Block mined successfully! (${result.attempts} attempts, ${result.hashRate} H/s, ${result.time.toFixed(2)}s)`, 'success');

                setTimeout(() => {
                    miningProgress.classList.remove('active');
                    mineButton.disabled = false;
                    mineButton.textContent = 'Mine Block';
                    isMining = false;

                    updateMetrics();
                    renderTransactionPool();
                    renderBlockchainVisualization();
                    renderMinersPanel();
                }, 1000);

            } catch (error) {
                logMessage(`Mining error: ${error.message}`, 'error');
                miningProgress.classList.remove('active');
                mineButton.disabled = false;
                mineButton.textContent = 'Mine Block';
                isMining = false;
            }
        }

        function stopMining() {
            if (isMining) {
                isMining = false;
                document.getElementById('miningProgress').classList.remove('active');
                document.getElementById('mineButton').disabled = false;
                document.getElementById('mineButton').textContent = 'Mine Block';
                logMessage("Mining stopped by user", 'warning');
            }
        }

        function updateDifficulty() {
            const newDifficulty = parseInt(document.getElementById('difficultySelect').value);
            blockchain.difficulty = newDifficulty;
            updateMetrics();
            logMessage(`Mining difficulty updated to ${newDifficulty}`, 'info');
        }

        function searchBlock() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) return;

            let block = null;
            
            // Try to parse as number (index)
            if (!isNaN(query)) {
                block = blockchain.getBlock(parseInt(query));
            } else {
                // Search by hash
                block = blockchain.getBlock(query);
            }

            if (block) {
                displayBlockDetails(block);
                logMessage(`Block found: ${block.index}`, 'success');
            } else {
                logMessage(`Block not found: ${query}`, 'error');
                document.getElementById('blockDetails').style.display = 'none';
            }
        }

        function validateChain() {
            const result = blockchain.isChainValid();
            const container = document.getElementById('validationResults');
            
            if (result.valid) {
                container.innerHTML = `
                    <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid #10b981; border-radius: 8px; padding: 20px; color: #10b981;">
                        <h3>✅ Blockchain Valid</h3>
                        <p>All blocks are properly linked and secure.</p>
                    </div>
                `;
                logMessage("Chain validation: VALID", 'success');
            } else {
                container.innerHTML = `
                    <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; border-radius: 8px; padding: 20px; color: #ef4444;">
                        <h3>❌ Blockchain Invalid</h3>
                        <p>${result.error}</p>
                    </div>
                `;
                logMessage(`Chain validation: INVALID - ${result.error}`, 'error');
            }
            
            updateMetrics();
        }

        function exportBlockchain() {
            const data = {
                chain: blockchain.chain.map(block => ({
                    index: block.index,
                    timestamp: block.timestamp,
                    previousHash: block.previousHash,
                    transactions: block.transactions.map(tx => tx.toDict()),
                    merkleRoot: block.merkleRoot,
                    nonce: block.nonce,
                    hash: block.hash
                })),
                pendingTransactions: blockchain.pendingTransactions.map(tx => tx.toDict()),
                difficulty: blockchain.difficulty,
                blockReward: blockchain.blockReward,
                miners: Object.fromEntries(blockchain.miners)
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `blockchain_export_${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);

            logMessage('Blockchain exported successfully', 'success');
        }

        function resetBlockchain() {
            if (confirm('Are you sure you want to reset the blockchain? This will remove all blocks and transactions.')) {
                blockchain = new Blockchain();
                currentHashRate = 0;
                
                updateMetrics();
                renderTransactionPool();
                renderBlockchainVisualization();
                renderMinersPanel();
                
                document.getElementById('blockDetails').style.display = 'none';
                document.getElementById('validationResults').innerHTML = '';
                
                logMessage('Blockchain reset successfully', 'warning');
            }
        }

        // Auto-mine toggle
        document.getElementById('autoMine').addEventListener('change', (e) => {
            autoMineEnabled = e.target.value === 'true';
            logMessage(`Auto-mining ${autoMineEnabled ? 'enabled' : 'disabled'}`, 'info');
        });

        // Block reward update
        document.getElementById('blockReward').addEventListener('change', (e) => {
            blockchain.blockReward = parseFloat(e.target.value) || 10;
            logMessage(`Block reward updated to $${blockchain.blockReward}`, 'info');
        });

        // Sample address suggestions
        const sampleAddresses = ['Alice_2024', 'Bob_Mining', 'Charlie_Exchange', 'Dave_Trader', 'Eve_Validator', 'Frank_Node'];
        
        ['senderAddress', 'receiverAddress', 'minerAddress'].forEach(id => {
            const input = document.getElementById(id);
            input.addEventListener('focus', () => {
                if (!input.value) {
                    input.value = sampleAddresses[Math.floor(Math.random() * sampleAddresses.length)];
                }
            });
        });

        // Search on Enter key
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchBlock();
            }
        });

        // Initialize
        function initialize() {
            updateMetrics();
            renderBlockchainVisualization();
            renderTransactionPool();
            renderMinersPanel();
            logMessage('Advanced Blockchain Simulator Pro initialized', 'success');
        }

        // Start the application
        initialize();
    </script>
</body>
</html>